# This file was generated by the excavator check 'excavator/manage-circleci' as specified in .circleci/template.sh.
# To request a modification to the general template, file an issue on Excavator.
# To manually manage the CircleCI configuration for this project, remove the .circleci/template.sh file.

version: 2.1

orbs:
  go-jobs: palantir/go-jobs@0.5.0

image-version: &image-version "cimg/go:1.23.2-browsers"

executors:
  standard-executor:
    docker:
      - image: *image-version
    resource_class: medium

# Filter that matches all tags (will run on every build).
all-tags-filter: &all-tags-filter
  filters: { tags: { only: /.*/ } }

# Filter that matches any branch besides primary branch and ignores all tags except for release candidates
pull-request-filter: &pull-request-filter
  filters:
    tags:
      only: /.*-rc.*/
    branches:
      ignore:
        - develop

requires_jobs: &requires_jobs
  - verify

workflows:
  version: 2
  verify:
    jobs:
      - go-jobs/godel_verify:
          name: "verify"
          executor: "standard-executor"
          <<: *all-tags-filter
      - go-jobs/circle_all:
          name: "circle-all"
          image: "busybox:1.36.1"
          requires: *requires_jobs
          <<: *pull-request-filter
